<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CV — Stelios Prentakis</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Comfortaa:wght@600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/png" href="assets/favicon.png" />
  <meta name="color-scheme" content="dark" />
  <meta name="theme-color" content="#050608" />
  <meta name="description" content="Curriculum Vitae of Stelios Prentakis — undergraduate researcher in theoretical computer science and quantum computing." />
</head>


<body>
  <canvas id="bgfx" class="bg" aria-hidden="true"></canvas>

  <header class="site-header">
    <a class="brand" href="index.html">Home</a>
    <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">☰</button>
    <nav class="site-nav" id="site-nav">
      <a href="cv.html" aria-current="page">CV</a>
      <a href="tutoring.html">Tutoring Material</a>
      <a href="updates.html">Project Updates</a>
    </nav>
  </header>

  <main>
    <section class="section reveal">
      <header class="section-head">
        <h2>My CV</h2>
      </header>
      <div class="grid two">
        <article class="card lift">
          <h3>Download</h3>
          <p style="margin-bottom: 16px;">Get my full CV in PDF format.</p>
          <a class="btn primary" href="assets/autoCV.pdf" id="cv-download-link">Download CV (PDF)</a>
          <h3 style="margin-top: 24px;">Contact Me</h3>
          <ul class="inline-icons" id="contact-links">
            <!-- Loaded from data/cv.json -->
          </ul>
        </article>
        <article class="card lift">
          <h3>About</h3>
          <p id="about-text"><!-- Loaded from data/cv.json --></p>
        </article>
      </div>
    </section>

    <!-- CV Sections loaded dynamically -->
    <div id="cv-sections-container"></div>
  </main>

  <footer class="site-footer">
    <p>&copy; <span id="year"></span> Stelios Prentakis</p>
  </footer>

  <script>
    // Navigation toggle
    const btn = document.querySelector('.nav-toggle');
    const nav = document.getElementById('site-nav');
    if (btn) {
      btn.addEventListener('click', () => {
        const open = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!open));
        nav.classList.toggle('open');
      });
    }
    
    // Reveal animation
    const observer = new IntersectionObserver((es) => {
      es.forEach(e => {
        if (e.isIntersecting) {
          e.target.classList.add('reveal-in');
          observer.unobserve(e.target);
        }
      });
    }, { threshold: 0.15 });
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
    
    // Year
    document.getElementById('year').textContent = new Date().getFullYear();
    
    // Load CV data from JSON
    async function loadCVData() {
      try {
        const response = await fetch('data/cv.json');
        const data = await response.json();
        
        // Update about text
        document.getElementById('about-text').textContent = data.about;
        
        // Update CV download link
        document.getElementById('cv-download-link').href = data.cvPdfUrl;
        
        // Render contact links
        const contactContainer = document.getElementById('contact-links');
        contactContainer.innerHTML = data.contacts.map(contact => 
          `<li><a href="${contact.url}">${contact.label}</a></li>`
        ).join('');
        
        // Render CV sections
        const sectionsContainer = document.getElementById('cv-sections-container');
        if (data.sections && data.sections.length > 0) {
          sectionsContainer.innerHTML = data.sections.map(section => {
            const itemsHtml = section.items.map(item => {
              const subtitleHtml = item.subtitle ? `<span class="cv-item-subtitle">${item.subtitle}</span>` : '';
              const dateHtml = item.date ? `<span class="cv-item-date">${item.date}</span>` : '';
              const descHtml = item.description ? `<p class="cv-item-desc">${item.description}</p>` : '';
              const detailsHtml = item.details && item.details.length > 0 
                ? `<ul class="cv-item-details">${item.details.map(d => `<li>${d}</li>`).join('')}</ul>` 
                : '';
              
              return `
                <article class="cv-item card lift">
                  <div class="cv-item-header">
                    <h3 class="cv-item-title">${item.title}</h3>
                    ${dateHtml}
                  </div>
                  ${subtitleHtml}
                  ${descHtml}
                  ${detailsHtml}
                </article>
              `;
            }).join('');
            
            const iconHtml = section.icon ? `<span class="section-icon">${section.icon}</span> ` : '';
            
            return `
              <section class="section reveal" id="cv-${section.id}">
                <header class="section-head">
                  <h2>${iconHtml}${section.title}</h2>
                </header>
                <div class="cv-items-grid">
                  ${itemsHtml}
                </div>
              </section>
            `;
          }).join('');
          
          // Observe new sections for reveal animation
          document.querySelectorAll('#cv-sections-container .reveal').forEach(el => observer.observe(el));
        }
      } catch (err) {
        console.error('Failed to load CV data:', err);
      }
    }
    
    loadCVData();
    
    // Canvas background
    const canvas = document.getElementById('bgfx');
    const ctx = canvas.getContext('2d');
    let w, h, dpr;
    
    function resize() {
      dpr = Math.min(devicePixelRatio || 1, 2);
      w = canvas.width = Math.floor(innerWidth * dpr);
      h = canvas.height = Math.floor(innerHeight * dpr);
      canvas.style.width = innerWidth + 'px';
      canvas.style.height = innerHeight + 'px';
    }
    resize();
    addEventListener('resize', resize);
    
    const prefersReduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
    const N = 40;
    const SPEED = 0.05;
    const nodes = Array.from({ length: N }, () => ({
      x: Math.random() * w,
      y: Math.random() * h,
      vx: (Math.random() * 2 - 1) * SPEED * dpr,
      vy: (Math.random() * 2 - 1) * SPEED * dpr,
      phase: Math.random() * Math.PI * 2,
      freq: 0.005 + Math.random() * 0.01
    }));
    
    let time = 0;
    
    function tick() {
      ctx.clearRect(0, 0, w, h);
      
      const g1 = ctx.createRadialGradient(w * 0.15, h * 0.15, 0, w * 0.15, h * 0.15, Math.max(w, h) * 0.6);
      g1.addColorStop(0, 'rgba(30, 70, 110, 0.12)');
      g1.addColorStop(1, 'rgba(0, 0, 0, 0)');
      ctx.fillStyle = g1;
      ctx.fillRect(0, 0, w, h);
      
      const TH = 180 * dpr;
      
      for (let i = 0; i < N; i++) {
        const a = nodes[i];
        for (let j = i + 1; j < N; j++) {
          const b = nodes[j];
          const d = Math.hypot(a.x - b.x, a.y - b.y);
          if (d < TH) {
            const alpha = (1 - d / TH) * 0.12;
            ctx.strokeStyle = `rgba(90, 228, 255, ${alpha})`;
            ctx.lineWidth = 1 * dpr;
            ctx.beginPath();
            ctx.moveTo(a.x, a.y);
            ctx.lineTo(b.x, b.y);
            ctx.stroke();
          }
        }
      }
      
      for (const n of nodes) {
        const pulse = Math.sin(time * n.freq + n.phase) * 0.3 + 0.7;
        ctx.fillStyle = `rgba(167, 139, 250, ${0.5 + pulse * 0.3})`;
        ctx.beginPath();
        ctx.arc(n.x, n.y, (1.5 + pulse * 0.5) * dpr, 0, Math.PI * 2);
        ctx.fill();
        
        if (!prefersReduced) {
          n.x += n.vx;
          n.y += n.vy;
          if (n.x < 0 || n.x > w) n.vx *= -1;
          if (n.y < 0 || n.y > h) n.vy *= -1;
        }
      }
      
      time++;
      if (!prefersReduced) requestAnimationFrame(tick);
    }
    
    if (prefersReduced) tick();
    else requestAnimationFrame(tick);
  </script>
</body>
</html>
